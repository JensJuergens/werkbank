---
title: "Daily Production Simulation"
date: 2019-03-29
tags: [simulation, production]
excerpt: "production, simulation"
mathjax: true
header:
  overlay_image: /images/windDenmark.jpg

---
## Data Description
What you see in the plot below are the daily production profiles of a German wind farm (turquoise) and a Romanian solar park (golden).
<img src="{{ site.url }}{{ site.baseurl }}/images/production_profile.jpeg" alt="Data Source: Transparency Reports Statistics">
After having a first look at the chart, one observes a clear yearly, seasonal pattern which results from the availability of the natural resources wind and sun. This results from the fact, that there is a lot more wind in the winter season as in summertime. Consequently the wind production volume rises with the beginning of the winter season. Looking at the solar production profile, we observe quite the opposite behaviour, as sun intensity is more prominent in summertime. Of course this results in rising solar production in respective season. This pattern can further be drilled down to monthly as well as weekly seasonalities.
What both charts have in common is a production behaviour which quickly returns to its seasonal mean after rapidly surging with a spike. Evidently these spikes appear far more often and are thus more prevalent in the wind production than to a solar power plant. This is also due to the fact, that we generally experience wind more unstable than cozy sun intensity. Consequently the renewable asset class wind should be far more volatile than the Romanian photovoltaic power plant.
## The model
In terms of model formulation we stick to the model of Lucia&Schwartz (cf. [link](https://link.springer.com/article/10.1023/A:1013846631785)) and adapt it to the power production case. We are going to evaluate the forecasting performance of this model at the end of this post. The model is attractive as it is tractable and relatively easy to calculate. Using this kind of model for production simulation purposes is not as unusual as it might seem at first sight (cf. Benth [link](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2979341))

$$ S(t) =  exp(f(t)+X(t)) \\$$
$$ dX(t) = -\alpha X(t)dt+\sigma dW(t) \\$$
$$ f(t)  =  a_0+\sum_{i=1}^6[a_i cos(2\pi\gamma_it)+b_i sin(2\pi\gamma_i t)] $$

The truncated fourier series $f(t)$ is used to describe seasonality seen in the data description above. A lot of different ways to capture seasonality have been tried out. We will use this seasonality approach as it is quite tractable and captures yearly, monthly as well as daily seasonalities. We set the parameters $$ \gamma_1 = 1, \gamma_2 = 2 ,\gamma_3 = 4, \gamma_4 = \frac{365}{7}, \gamma_5 = 2*\frac{365}{7}, \gamma_6 = 4*\frac{365}{7} $$, which corresponds to annually, semi-annually, quarterly, weekly, semi-weekly and quarter-weekly seasonality factors.
## Calibration
As pointed out above seasonality seems to play a major role in our time series. Hence we will firstly estimate the seasonality with a simple linear regression of trigonometric basis functions against the logarithm of observed daily production volumes. To uncover yearly seasonalities we will use a 3 years of historical volumes. Results of the linear model are as follows:
<figure class="half">
    <a href="/images/wind_german_season.jpeg"><img src="/images/wind_german_season.jpeg"></a>
    <a href="/images/solar_romania_season.jpeg"><img src="/images/solar_romania_season.jpeg"></a>
    <figcaption>Seasonality per asset estimated by truncated fourier series </figcaption>
</figure>
To carry out a sensible calibration of the model parameters, one has to remove disturbing patters in the time series in order to arrive at the pure stochastic part. After determining the seasonality, we deseasonalize our log-Spot data by subtracting the seasonality function from the data.
<img src="{{ site.url }}{{ site.baseurl }}/images/production_profile_deseasonalised.jpeg" alt="Data Source: Own R calculation">
Now we are half-way done in extracting the pure stochastic part in our data. One clearly sees that there are still artefacts in our deseasonalized data, which will mislead our final parameter estimation for the Ornstein-Uhlenbeck model. Hence we winsorize the spikes out of the data and arrive at the following stage:
<figure class="half">
    <a href="/images/wind_german_deseason_winsor.jpeg"><img src="/images/wind_german_deseason_winsor.jpeg"></a>
    <a href="/images/solar_romania_deseason_winsor.jpeg"><img src="/images/solar_romania_deseason_winsor.jpeg"></a>
    <figcaption>Seasonality per asset estimated by truncated fourier series </figcaption>
</figure>

## Backtesting of calibration results

Here is some basic text.

And here is some *italics*.
Here is some **bold** text.

What about a [link](www.google.com).

Bullet points:
* Example1
* Example2

Phyton code block

#container {
  import numpy as np
}

R code block
```r
library(tidyverse)

```

Here is some math:

\[p(\theta) = \mathbf{\prod}_{i,c}p(\mathbf{\theta}^i(c))\]

$$
    \begin{matrix}
    1 & x & x^2 \\
    1 & y & y^2 \\
    1 & z & z^2 \\
    \end{matrix}
$$

$$ E = mc^2 $$

$$  p(\theta) = \mathbf{\prod}_{i,c}p(\mathbf{\theta}^i(c)) $$
